import numpy as np
import torch
TASKINFO = {'camera_height': 1.7, 'task_info_metrics': {'ep_length': 52, 'reward': 21.114161723265173, 'task_info': {'source_object_id': 'Pot|-00.61|+00.80|-03.42', 'goal_object_id': 'Tomato|-03.13|+00.92|-00.39', 'init_location': {'object_id': 'Pot|-00.61|+00.80|-03.42', 'object_location': {'x': -1.4713976383209229, 'y': 1.0353000164031982, 'z': -3.611088514328003}, 'scene_name': 'FloorPlan28_physics', 'countertop_id': 'CounterTop|-01.94|+00.98|-03.67', 'agent_pose': {'name': 'agent', 'position': {'x': -1.5, 'y': 0.9009982347488403, 'z': -3.0}, 'rotation': {'x': -0.0, 'y': 180.0, 'z': 0.0}, 'cameraHorizon': 9.999999046325684, 'isStanding': True, 'inHighFrictionArea': False}, 'visibility': True}, 'goal_location': {'object_id': 'Tomato|-03.13|+00.92|-00.39', 'object_location': {'x': -2.8819456100463867, 'y': 1.0804426670074463, 'z': -0.4770221710205078}, 'scene_name': 'FloorPlan28_physics', 'countertop_id': 'DiningTable|-03.22|00.00|-00.45', 'agent_pose': {'name': 'agent', 'position': {'x': -2.5, 'y': 0.9009982347488403, 'z': -0.5}, 'rotation': {'x': -0.0, 'y': 270.0, 'z': 0.0}, 'cameraHorizon': 10.000000953674316, 'isStanding': True, 'inHighFrictionArea': False}, 'visibility': True}, 'agent_initial_state': {'name': 'agent', 'position': {'x': -1.75, 'y': 0.9009982347488403, 'z': -1.0}, 'rotation': {'x': -0.0, 'y': 180.0, 'z': 0.0}, 'cameraHorizon': 9.999999046325684, 'isStanding': True, 'inHighFrictionArea': False}, 'initial_object_location': {'name': 'Pot_d2affe99', 'position': {'x': -1.4713976383209229, 'y': 0.936113178730011, 'z': -3.611088275909424}, 'rotation': {'x': 0.04092847928404808, 'y': 314.999755859375, 'z': 0.0015551956603303552}, 'visible': False, 'isInteractable': False, 'receptacle': True, 'toggleable': False, 'isToggled': False, 'breakable': False, 'isBroken': False, 'canFillWithLiquid': True, 'isFilledWithLiquid': False, 'fillLiquid': None, 'dirtyable': True, 'isDirty': False, 'canBeUsedUp': False, 'isUsedUp': False, 'cookable': False, 'isCooked': False, 'temperature': 'RoomTemp', 'isHeatSource': False, 'isColdSource': False, 'sliceable': False, 'isSliced': False, 'openable': False, 'isOpen': False, 'openness': 0.0, 'pickupable': True, 'isPickedUp': False, 'moveable': False, 'mass': 0.5699999928474426, 'salientMaterials': ['Metal'], 'receptacleObjectIds': [], 'distance': 2.6261444091796875, 'objectType': 'Pot', 'objectId': 'Pot|-00.61|+00.80|-03.42', 'assetId': '', 'parentReceptacles': ['CounterTop|-01.94|+00.98|-03.67'], 'controlledObjects': None, 'isMoving': False, 'axisAlignedBoundingBox': {'cornerPoints': [[-1.296372413635254, 1.0852491855621338, -3.4369072914123535], [-1.296372413635254, 1.0852491855621338, -3.7847752571105957], [-1.296372413635254, 0.9362165927886963, -3.4369072914123535], [-1.296372413635254, 0.9362165927886963, -3.7847752571105957], [-1.6442406177520752, 1.0852491855621338, -3.4369072914123535], [-1.6442406177520752, 1.0852491855621338, -3.7847752571105957], [-1.6442406177520752, 0.9362165927886963, -3.4369072914123535], [-1.6442406177520752, 0.9362165927886963, -3.7847752571105957]], 'center': {'x': -1.4703065156936646, 'y': 1.010732889175415, 'z': -3.6108412742614746}, 'size': {'x': 0.3478682041168213, 'y': 0.1490325927734375, 'z': 0.3478679656982422}}, 'objectOrientedBoundingBox': {'cornerPoints': [[-1.4509308338165283, 0.9362061023712158, -3.3910000324249268], [-1.6914857625961304, 0.9361968636512756, -3.631556987762451], [-1.491864562034607, 0.9363985657691956, -3.831176519393921], [-1.2513096332550049, 0.9364078044891357, -3.5906195640563965], [-1.451008915901184, 1.0850543975830078, -3.39092755317688], [-1.6915638446807861, 1.0850450992584229, -3.6314845085144043], [-1.4919426441192627, 1.0852468013763428, -3.831104278564453], [-1.2513877153396606, 1.0852559804916382, -3.5905473232269287]]}}, 'initial_hand_state': {'position': {'x': -2.0789999961853027, 'y': 1.5309982299804688, 'z': -1.350000023841858}, 'rotation': {'x': 0, 'y': 0, 'z': 0}}, 'source_object_query': 0, 'goal_object_query': 0, 'episode_number': 6940.65442360907, 'visualization_source': {'object_id': 'Pot|-00.61|+00.80|-03.42', 'object_location': {'x': -1.4713976383209229, 'y': 1.0353000164031982, 'z': -3.611088514328003}, 'scene_name': 'FloorPlan28_physics', 'countertop_id': 'CounterTop|-01.94|+00.98|-03.67', 'agent_pose': {'name': 'agent', 'position': {'x': -1.5, 'y': 0.9009982347488403, 'z': -3.0}, 'rotation': {'x': -0.0, 'y': 180.0, 'z': 0.0}, 'cameraHorizon': 9.999999046325684, 'isStanding': True, 'inHighFrictionArea': False}, 'visibility': True}, 'visualization_target': {'object_id': 'Tomato|-03.13|+00.92|-00.39', 'object_location': {'x': -2.8819456100463867, 'y': 1.0804426670074463, 'z': -0.4770221710205078}, 'scene_name': 'FloorPlan28_physics', 'countertop_id': 'DiningTable|-03.22|00.00|-00.45', 'agent_pose': {'name': 'agent', 'position': {'x': -2.5, 'y': 0.9009982347488403, 'z': -0.5}, 'rotation': {'x': -0.0, 'y': 270.0, 'z': 0.0}, 'cameraHorizon': 10.000000953674316, 'isStanding': True, 'inHighFrictionArea': False}, 'visibility': True}}, 'metric/action_stat/MoveArmHeightP': 0.057692307692307696, 'metric/action_stat/MoveArmHeightM': 0.038461538461538464, 'metric/action_stat/MoveArmXP': 0.057692307692307696, 'metric/action_stat/MoveArmXM': 0.0, 'metric/action_stat/MoveArmYP': 0.0, 'metric/action_stat/MoveArmYM': 0.21153846153846154, 'metric/action_stat/MoveArmZP': 0.07692307692307693, 'metric/action_stat/MoveArmZM': 0.0, 'metric/action_stat/MoveAhead': 0.4230769230769231, 'metric/action_stat/RotateRight': 0.09615384615384616, 'metric/action_stat/RotateLeft': 0.038461538461538464, 'metric/action_success/MoveArmHeightP': 0.9999996666667778, 'metric/action_success/MoveArmHeightM': 0.99999950000025, 'metric/action_success/MoveArmXP': 0.9999996666667778, 'metric/action_success/MoveArmXM': 0.0, 'metric/action_success/MoveArmYP': 0.0, 'metric/action_success/MoveArmYM': 0.9999999090909174, 'metric/action_success/MoveArmZP': 0.9999997500000625, 'metric/action_success/MoveArmZM': 0.0, 'metric/action_success/MoveAhead': 0.9999999545454565, 'metric/action_success/RotateRight': 0.99999980000004, 'metric/action_success/RotateLeft': 0.99999950000025, 'metric/action_success/total': 1.0, 'metric/average/final_obj_distance_from_goal': 0.2108279857941306, 'metric/average/final_arm_distance_from_obj': 0.15316141593863847, 'metric/average/final_obj_pickup/total': 1, 'metric/average/original_distance': 3.2328035999200724, 'metric/average/final_obj_pickup/Pot': True, 'metric/average/final_success/Tomato': True, 'metric/average/ratio_distance_left': 0.06521521622883095, 'metric/average/eplen_pickup': 23, 'metric/average/success_wo_disturb': False, 'metric/average/eplen_success': 52, 'metric/average/number_of_unwanted_moved_objects': 3, 'success': True}, 'action_sequence': ['', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'RotateLeft', 'MoveAhead', 'MoveArmYM', 'MoveArmYM', 'MoveArmYM', 'MoveArmYM', 'MoveArmYM', 'MoveArmYM', 'MoveArmYM', 'MoveArmYM', 'MoveArmZP', 'MoveArmHeightM', 'MoveArmZP', 'MoveArmZP', 'MoveArmHeightP', 'RotateRight', 'RotateRight', 'RotateRight', 'MoveAhead', 'MoveAhead', 'MoveArmHeightP', 'MoveAhead', 'MoveAhead', 'RotateRight', 'MoveArmHeightP', 'MoveAhead', 'MoveAhead', 'RotateRight', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'RotateLeft', 'MoveArmYM', 'MoveArmYM', 'MoveArmYM', 'MoveArmXP', 'MoveArmXP', 'MoveArmHeightM', 'MoveArmZP', 'MoveArmXP'], 'logger_number': 217}









TASKINFO2 = {'camera_height': 2, 'task_info_metrics': {'ep_length': 62, 'reward': 19.36826022437156, 'task_info': {'source_object_id': 'Lettuce|+00.89|+01.10|+00.13', 'goal_object_id': 'Cup|+01.54|+01.03|+00.66', 'init_location': {'object_id': 'Lettuce|+00.89|+01.10|+00.13', 'object_location': {'x': 0.6572713851928711, 'y': 1.1398999691009521, 'z': -1.5480979681015015}, 'scene_name': 'FloorPlan29_physics', 'countertop_id': 'CounterTop|+00.20|+01.08|-01.51', 'agent_pose': {'name': 'agent', 'position': {'x': 0.75, 'y': 0.9317981004714966, 'z': -0.75}, 'rotation': {'x': -0.0, 'y': 180.0, 'z': 0.0}, 'cameraHorizon': 9.999999046325684, 'isStanding': True, 'inHighFrictionArea': False}, 'visibility': True}, 'goal_location': {'object_id': 'Cup|+01.54|+01.03|+00.66', 'object_location': {'x': 0.29410406947135925, 'y': 1.1363999843597412, 'z': 0.7169750332832336}, 'scene_name': 'FloorPlan29_physics', 'countertop_id': 'CounterTop|+00.97|+01.08|+00.42', 'agent_pose': {'name': 'agent', 'position': {'x': -0.25, 'y': 0.9317981004714966, 'z': 1.25}, 'rotation': {'x': -0.0, 'y': 90.0, 'z': 0.0}, 'cameraHorizon': 10.000000953674316, 'isStanding': True, 'inHighFrictionArea': False}, 'visibility': True}, 'agent_initial_state': {'name': 'agent', 'position': {'x': 1.75, 'y': 0.9317981004714966, 'z': -0.5}, 'rotation': {'x': -0.0, 'y': 225.0, 'z': 0.0}, 'cameraHorizon': 10.0, 'isStanding': True, 'inHighFrictionArea': False}, 'initial_object_location': {'name': 'Lettuce_21a9908e', 'position': {'x': 0.6572715044021606, 'y': 1.1435599327087402, 'z': -1.5480979681015015}, 'rotation': {'x': 2.7701146602630615, 'y': 299.7577819824219, 'z': 353.6667785644531}, 'visible': True, 'isInteractable': True, 'receptacle': False, 'toggleable': False, 'isToggled': False, 'breakable': False, 'isBroken': False, 'canFillWithLiquid': False, 'isFilledWithLiquid': False, 'fillLiquid': None, 'dirtyable': False, 'isDirty': False, 'canBeUsedUp': False, 'isUsedUp': False, 'cookable': False, 'isCooked': False, 'temperature': 'RoomTemp', 'isHeatSource': False, 'isColdSource': False, 'sliceable': True, 'isSliced': False, 'openable': False, 'isOpen': False, 'openness': 0.0, 'pickupable': True, 'isPickedUp': False, 'moveable': False, 'mass': 0.4699999988079071, 'salientMaterials': ['Food'], 'receptacleObjectIds': None, 'distance': 1.5288584232330322, 'objectType': 'Lettuce', 'objectId': 'Lettuce|+00.89|+01.10|+00.13', 'assetId': '', 'parentReceptacles': ['CounterTop|+00.20|+01.08|-01.51'], 'controlledObjects': None, 'isMoving': False, 'axisAlignedBoundingBox': {'cornerPoints': [[0.7534252405166626, 1.2303389310836792, -1.473264455795288], [0.7534252405166626, 1.2303389310836792, -1.636051893234253], [0.7534252405166626, 1.084380030632019, -1.473264455795288], [0.7534252405166626, 1.084380030632019, -1.636051893234253], [0.5578805208206177, 1.2303389310836792, -1.473264455795288], [0.5578805208206177, 1.2303389310836792, -1.636051893234253], [0.5578805208206177, 1.084380030632019, -1.473264455795288], [0.5578805208206177, 1.084380030632019, -1.636051893234253]], 'center': {'x': 0.6556528806686401, 'y': 1.1573594808578491, 'z': -1.5546581745147705}, 'size': {'x': 0.19554471969604492, 'y': 0.14595890045166016, 'z': 0.16278743743896484}}, 'objectOrientedBoundingBox': {'cornerPoints': [[0.5989710092544556, 1.0722190141677856, -1.4435052871704102], [0.5267706513404846, 1.0881954431533813, -1.5682324171066284], [0.7066000699996948, 1.0982182025909424, -1.6710457801818848], [0.7788004279136658, 1.0822418928146362, -1.5463186502456665], [0.6008524894714355, 1.2153334617614746, -1.4262628555297852], [0.5286521315574646, 1.2313097715377808, -1.5509899854660034], [0.7084815502166748, 1.2413326501846313, -1.6538033485412598], [0.7806819081306458, 1.2253562211990356, -1.5290762186050415]]}}, 'initial_hand_state': {'position': {'x': 1.269874095916748, 'y': 1.561798095703125, 'z': -0.5148493647575378}, 'rotation': {'x': 0, 'y': 0, 'z': 0}}, 'source_object_query': torch.Tensor([0]), 'goal_object_query': torch.Tensor([0]), 'source_object_query_feature': np.array([1]), 'goal_object_query_feature': np.array([0]), 'episode_number': 4004.700220545002, 'visualization_source': {'object_id': 'Lettuce|+00.89|+01.10|+00.13', 'object_location': {'x': 0.6572713851928711, 'y': 1.1398999691009521, 'z': -1.5480979681015015}, 'scene_name': 'FloorPlan29_physics', 'countertop_id': 'CounterTop|+00.20|+01.08|-01.51', 'agent_pose': {'name': 'agent', 'position': {'x': 0.75, 'y': 0.9317981004714966, 'z': -0.75}, 'rotation': {'x': -0.0, 'y': 180.0, 'z': 0.0}, 'cameraHorizon': 9.999999046325684, 'isStanding': True, 'inHighFrictionArea': False}, 'visibility': True}, 'visualization_target': {'object_id': 'Cup|+01.54|+01.03|+00.66', 'object_location': {'x': 0.29410406947135925, 'y': 1.1363999843597412, 'z': 0.7169750332832336}, 'scene_name': 'FloorPlan29_physics', 'countertop_id': 'CounterTop|+00.97|+01.08|+00.42', 'agent_pose': {'name': 'agent', 'position': {'x': -0.25, 'y': 0.9317981004714966, 'z': 1.25}, 'rotation': {'x': -0.0, 'y': 90.0, 'z': 0.0}, 'cameraHorizon': 10.000000953674316, 'isStanding': True, 'inHighFrictionArea': False}, 'visibility': True}}, 'metric/action_stat/MoveArmHeightP': 0.03225806451612903, 'metric/action_stat/MoveArmHeightM': 0.04838709677419355, 'metric/action_stat/MoveArmXP': 0.016129032258064516, 'metric/action_stat/MoveArmXM': 0.016129032258064516, 'metric/action_stat/MoveArmYP': 0.0, 'metric/action_stat/MoveArmYM': 0.08064516129032258, 'metric/action_stat/MoveArmZP': 0.06451612903225806, 'metric/action_stat/MoveArmZM': 0.016129032258064516, 'metric/action_stat/MoveAhead': 0.4838709677419355, 'metric/action_stat/RotateRight': 0.1774193548387097, 'metric/action_stat/RotateLeft': 0.06451612903225806, 'metric/action_success/MoveArmHeightP': 0.99999950000025, 'metric/action_success/MoveArmHeightM': 0.6666664444445185, 'metric/action_success/MoveArmXP': 0.9999990000010001, 'metric/action_success/MoveArmXM': 0.9999990000010001, 'metric/action_success/MoveArmYP': 0.0, 'metric/action_success/MoveArmYM': 0.99999980000004, 'metric/action_success/MoveArmZP': 0.9999997500000625, 'metric/action_success/MoveArmZM': 0.9999990000010001, 'metric/action_success/MoveAhead': 0.9999999666666678, 'metric/action_success/RotateRight': 0.9999999090909174, 'metric/action_success/RotateLeft': 0.9999997500000625, 'metric/action_success/total': 0.9838709677419355, 'metric/average/final_obj_distance_from_goal': 0.28975030728632944, 'metric/average/final_arm_distance_from_obj': 0.24455502620104494, 'metric/average/final_obj_pickup/total': 1, 'metric/average/original_distance': 2.490811436358089, 'metric/average/final_obj_pickup/Lettuce': True, 'metric/average/final_success/Cup': True, 'metric/average/ratio_distance_left': 0.11632767661850167, 'metric/average/eplen_pickup': 18, 'metric/average/success_wo_disturb': True, 'metric/average/eplen_success': 62, 'metric/average/number_of_unwanted_moved_objects': 0, 'success': True}, 'action_sequence': ['', 'MoveAhead', 'RotateRight', 'MoveAhead', 'MoveAhead', 'RotateLeft', 'MoveAhead', 'RotateLeft', 'MoveArmYM', 'MoveArmZP', 'MoveArmHeightM', 'MoveArmYM', 'MoveArmYM', 'MoveArmHeightM', 'MoveArmZP', 'MoveArmZP', 'MoveArmZP', 'MoveArmHeightM', 'MoveArmYM', 'MoveArmHeightP', 'RotateRight', 'RotateRight', 'MoveArmHeightP', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveArmZM', 'MoveAhead', 'MoveAhead', 'RotateRight', 'RotateRight', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'RotateLeft', 'MoveAhead', 'RotateRight', 'RotateRight', 'RotateLeft', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'RotateRight', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveAhead', 'MoveArmXM', 'RotateRight', 'MoveAhead', 'RotateRight', 'MoveArmXP', 'RotateRight', 'MoveAhead', 'MoveArmYM', 'MoveAhead'], 'logger_number': 13}